#renv::activate()
#renv::restore()

# Load packages ------
library(SqlRender)
library(CirceR)
library(CDMConnector)
library(IncidencePrevalence)
library(here)
library(DBI)
library(dbplyr)
library(tidyr)
library(ggplot2)
library(gt)
library(dplyr)
library(readr)
library(log4r)
library(stringr)
library(RPostgres)
library(PatientProfiles)
library(CohortCharacteristics)
library(DiagrammeRsvg)
library(rsvg)
library(flextable)
library(gt)
library(officer)
library(writexl)
library(lubridate)
library(purrr)
library(broom)
library(tibble)
library(CohortConstructor)

# Connection details ------

# Database name
database_name <- "..."

# Connection details
server_dbi <- "..."
user       <- "..."
password   <- "..."
port       <- "..."
host       <- "..."

# DBI driver (change based on your dbms)
drv <- RPostgres::Postgres()

# Connection
# See https://darwin-eu.github.io/CDMConnector/articles/a04_DBI_connection_examples.html for examples
db <- DBI::dbConnect(
  drv,
  host = host,
  port = port,
  dbname = server_dbi,
  user = user,
  password = password
)

cdm_database_schema <- "..."
results_database_schema <- "..."

# cohort stem where cohorts will be instantiated
table_stem <- "..."

# Run study ------

source(here::here("RunStudy.R"))
#takes about 30 minutes to run in CMBD
print("Thanks for running this study!")

